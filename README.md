# TestApp

## Описание

TestApp — это приложение на Django, которое включает функционал управления ролями, ресурсами и разрешениями, а также профили пользователей.

## Установка и запуск

1. **Клонирование репозитория**

   ```bash
   git clone https://github.com/VeronikaPoteichuk/test.git
   cd test/TestApp
   ```

2. **Установка зависимостей**

   Убедитесь, что у вас установлен Python версии 3.11 и виртуальное окружение.
   ```bash
   python -m venv venv
   venv\Scripts\activate
   pip install -r requirements.txt
   ```

3. **Применение миграций**

   ```bash
   python manage.py migrate
   ```

4. **Загрузка данных**
    
    Из фикстур

   ```bash
   python manage.py loaddata rbac_fixture.json
   ```
    Из файла

   ```shell
   python manage.py shell
   >>>from authtest.test_data import create_test_rbac_data
   >>>create_test_rbac_data()
   ```

5. **Запуск сервера разработки**

   ```bash
   python manage.py collectstatic 
   python manage.py runserver
   ```

Приложение будет доступно по адресу: `http://127.0.0.1:8000`

## Основной функционал

- Управление ролями, ресурсами и разрешениями.
- Просмотр и редактирование профиля пользователя.
- Назначение ролей пользователям.

## Структура приложения

### 1. Модели

- **Role**: Определяет роли пользователей.
- **Resource**: Представляет объекты или области приложения, к которым предоставляется доступ.
- **Permission**: Определяет действия, которые можно выполнять над ресурсами.
- **RolePermission**: Связывает роли с разрешениями для конкретных ресурсов.
- **UserRole**: Связывает пользователей с их ролями.

### 2. Шаблоны

- Расположены в папке `authtest/templates`.
- Основные шаблоны:
  - `base.html`: Базовый шаблон для всех страниц.
  - `profile.html`: Шаблон для отображения профиля пользователя.
  - `assign_role.html`: Шаблон для назначения ролей.

### 3. Статические файлы

- Расположены в папке `authtest/static`.
- Основные файлы:
  - `auth_fetch.js`: Скрипт для работы с авторизацией.

### 4. Фикстуры

- Расположены в папке `authtest/fixtures`.
- Файл `rbac_fixture.json` содержит данные для загрузки ролей, ресурсов, разрешений и пользователей.

### 5. URL-ы

- Определены в файле `authtest/urls.py`.
- Основные маршруты:
  - `/profile/`: Просмотр профиля.
  - `/assign_role/`: Назначение ролей.

### 6. Middleware

- Реализовано в файле `authtest/middleware.py`.
- Используется для обработки запросов и управления доступом.

### 7. Тесты

- Расположены в папке `testы`.
- Покрывают функционал управления ролями, ресурсами и разрешениями.

## Структура управления доступом

В приложении реализована модель управления доступом на основе ролей (RBAC):

1. **Роли**:

   - Определяют уровень доступа пользователя.
   - Примеры: `admin`, `user`, `guest`.

2. **Ресурсы**:

   - Представляют объекты или области приложения, к которым предоставляется доступ.
   - Примеры: `profile` (профиль пользователя), `assign_role` (назначение ролей).

3. **Разрешения**:

   - Определяют действия, которые можно выполнять над ресурсами.
   - Примеры: `view_profile` (просмотр профиля), `edit_profile` (редактирование профиля).

4. **Связи ролей и разрешений**:

   - Каждая роль может быть связана с определёнными разрешениями для конкретных ресурсов.
   - Пример: роль `user` имеет разрешения `view_profile` и `edit_profile` для ресурса `profile`.

5. **Назначение ролей пользователям**:

   - Пользователи получают роли, которые определяют их доступ.
   - Пример: пользователь `admin` имеет роль `admin`.

## Дополнительная информация

- Фикстуры находятся в папке `authtest/fixtures`. Созданы из файла `authtest/test_data.py`
- Статические файлы и шаблоны расположены в соответствующих папках приложения `authtest`.
